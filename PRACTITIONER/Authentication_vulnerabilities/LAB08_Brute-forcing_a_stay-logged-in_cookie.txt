https://portswigger.net/web-security/learning-paths/authentication-vulnerabilities/vulnerabilities-in-other-authentication-mechanisms/authentication/other-mechanisms/lab-brute-forcing-a-stay-logged-in-cookie

Эта лаборатория позволяет пользователям оставаться в системе даже после закрытия сеанса браузера. Файл cookie, используемый для обеспечения этой функции, уязвим для перебора.

Чтобы решить лабораторную задачу, переберите файл cookie Карлоса, чтобы получить доступ к его странице «My account».


    Your credentials: wiener:peter
    Victim's username: carlos
    Candidate passwords

Solution:
1.   Запустив Burp, войдите в свою учетную запись, выбрав опцию «stay-logged-in». Обратите внимание, что при этом устанавливается файл cookie для регистрации в системе.

2.   Проверьте этот файл cookie на панели «Inspector» и обратите внимание, что он закодирован в Base64. Его декодированное значение — wiener:51dc30ddc473d43a6011e9ebba6ca770. Изучите длину и набор символов этой строки и обратите внимание, что это может быть хэш MD5. Учитывая, что открытый текст — это ваше имя пользователя, вы можете сделать обоснованное предположение, что это может быть хеш вашего пароля. Хэшируйте свой пароль с помощью MD5, чтобы подтвердить, что это так. Теперь мы знаем, что файл cookie устроен следующим образом:
base64(username+':'+md5HashOfPassword)

3. Выйдите из своей учетной записи.
4. В последнем файле GET /my-account выделите параметр «stay-logged-in» cookie для пребывания в системе и отправьте запрос в Burp Intruder.

5. Обратите внимание, что в Burp Intruder файл «stay-logged-in» cookie для регистрации в системе автоматически добавляется в качестве полезной нагрузки. Добавьте свой собственный пароль как одну полезную нагрузку.

6. В разделе «Payload processing» добавьте следующие правила по порядку. Эти правила будут применяться последовательно к каждой полезной нагрузке перед отправкой запроса.

    Hash: MD5
    Add prefix: wiener:
    Encode: Base64-encode


7.  Поскольку кнопка «Update email» отображается только при доступе к странице /my-account в состоянии аутентификации, мы можем использовать наличие или отсутствие этой кнопки, чтобы определить, успешно ли мы перебрали файл cookie. На вкладке «Settings» добавьте правило сопоставления grep, чтобы отмечать все ответы, содержащие строку «Update email». Начать атаку.
Обратите внимание, что сгенерированные полезные данные использовались для успешной загрузки страницы вашей учетной записи. Это подтверждает, что правила обработки полезных данных работают должным образом и вы смогли создать действительный файл cookie для своей учетной записи.
Внесите следующие изменения, а затем повторите эту атаку:

8.  Удалите свой собственный пароль из списка полезной нагрузки и вместо него добавьте список возможных паролей.
9.  Измените правило «Add prefix», чтобы добавить «carlos:» вместо «wiener:».

10.  Когда атака будет завершена, лаборатория будет решена. Обратите внимание, что только один запрос вернул ответ, содержащий сообщение Update email. Полезной нагрузкой этого запроса является действительный файл «stay-logged-in» cookie для регистрации в учетной записи Карлоса.


Как то решил)
d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw
