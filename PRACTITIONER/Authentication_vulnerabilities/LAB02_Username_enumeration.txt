https://portswigger.net/web-security/learning-paths/authentication-vulnerabilities/password-based-vulnerabilities/authentication/password-based/lab-username-enumeration-via-subtly-different-responses

Lab: Username enumeration via subtly different responses
Лабораторная работа: Перечисление имени пользователя с помощью слегка различающихся ответов.


Эта лаборатория тонко уязвима для атак с перебором имен пользователей и паролей. У него есть учетная запись с предсказуемым именем пользователя и паролем, которые можно найти в следующих списках слов:
    
    Candidate usernames
    https://portswigger.net/web-security/authentication/auth-lab-usernames
    
    Candidate passwords
    https://portswigger.net/web-security/authentication/auth-lab-passwords

Чтобы решить лабораторную работу, укажите допустимое имя пользователя, переберите пароль этого пользователя, а затем зайдите на страницу его учетной записи.


Решение

     При запущенном Burp отправьте неверное имя пользователя и пароль. Выделите параметр имени пользователя в запросе POST/login и отправьте его в Burp Intrumer.
     Обратите внимание, что на вкладке «Payloads» параметр имени пользователя автоматически помечается как позиция полезных данных. Убедитесь, что выбран тип полезных данных «Simple list», и добавьте список имен пользователей-кандидатов.
     На вкладке «Settings» в разделе «Grep - Extract» нажмите «Add». В появившемся диалоговом окне прокрутите ответ вниз, пока не найдете сообщение об ошибке «Invalid username or password.». С помощью мыши выделите текстовое содержимое сообщения. Остальные настройки будут скорректированы автоматически. Нажмите «ОК», а затем начните атаку.
     Когда атака завершится, обратите внимание на дополнительный столбец, содержащий извлеченное вами сообщение об ошибке. Отсортируйте результаты, используя этот столбец, чтобы заметить, что один из них немного отличается.
     Посмотрите внимательно на этот ответ и обратите внимание, что он содержит опечатку в сообщении об ошибке — вместо точки/точки стоит пробел в конце. Запишите это имя пользователя.

     Закройте атаку и вернитесь на вкладку «Позиции». Вставьте имя пользователя, которое вы только что определили, и добавьте позицию полезных данных в параметр password:
     username=identified-user&password=§invalid-password§
     На вкладке «Полезные данные» очистите список имен пользователей и замените его списком паролей. Начать атаку.
     Когда атака завершится, обратите внимание, что на один из запросов был получен ответ 302. Запишите этот пароль.

     Войдите в систему, используя имя пользователя и пароль, которые вы указали, и получите доступ к странице учетной записи пользователя, чтобы выполнить лабораторную работу.
     Примечание

     Также возможно взломать вход в систему с помощью одной атаки кластерной бомбой. Однако, как правило, гораздо эффективнее сначала перечислить допустимое имя пользователя, если это возможно.
     
     albuquerque
     username=albuquerque&password=trustno1
