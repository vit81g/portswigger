https://portswigger.net/web-security/learning-paths/authentication-vulnerabilities/password-based-vulnerabilities/authentication/password-based/lab-username-enumeration-via-response-timing

Lab: Username enumeration via response timing
Лабораторная работа: Перечисление имен пользователей по времени ответа.

Эта лаборатория уязвима для перечисления имен пользователей с использованием времени отклика. Чтобы решить лабораторную работу, укажите допустимое имя пользователя, переберите пароль этого пользователя, а затем зайдите на страницу его учетной записи.


    Your credentials: wiener:peter
    Candidate usernames
    https://portswigger.net/web-security/authentication/auth-lab-usernames
    
    Candidate passwords
    https://portswigger.net/web-security/authentication/auth-lab-passwords
    
Чтобы усложнить задачу, лаборатория также реализует форму защиты от грубой силы на основе IP. Однако это можно легко обойти, манипулируя заголовками HTTP-запросов.

Решение

1.   При работающем Burp отправьте неверное имя пользователя и пароль, а затем отправьте запрос POST /login в Burp Repeater. Поэкспериментируйте с разными именами пользователей и паролями. Обратите внимание, что ваш IP-адрес будет заблокирован, если вы сделаете слишком много неверных попыток входа в систему.
2.   Определите, что поддерживается заголовок X-Forwarded-For, который позволяет подделать ваш IP-адрес и обойти защиту от перебора на основе IP.
3.   Продолжайте экспериментировать с именами пользователей и паролями. Особое внимание обратите на время ответа. Обратите внимание: если имя пользователя недействительно, время ответа примерно такое же. Однако, когда вы вводите действительное имя пользователя (ваше собственное), время ответа увеличивается в зависимости от длины введенного вами пароля.
4.   Отправьте этот запрос в Burp Intrumer и выберите тип атаки для Pitchfork. Добавьте заголовок X-Forwarded-For.
5.   Добавьте позиции полезных данных для заголовка X-Forwarded-For и параметра имени username. Установите пароль на очень длинную строку символов (около 100 символов).
6.   На вкладке Payloads выберите набор полезных данных 1. Выберите тип полезных данных Numbers. Введите диапазон от 1 до 100 и установите шаг 1. Установите максимальное количество цифр на 0. Это будет использоваться для подмены вашего IP-адреса.
7.   Выберите набор полезных данных 2 и добавьте список имен пользователей. Начать атаку.
8.   Когда атака завершится, в верхней части диалогового окна нажмите «Columns» и выберите параметры «Response received» и «Response completed». Эти два столбца теперь отображаются в таблице результатов.
9.   Обратите внимание, что одно из времен ответа было значительно дольше, чем другие. Повторите этот запрос несколько раз, чтобы убедиться, что он постоянно занимает больше времени, а затем запишите это имя пользователя.
10.  Создайте новую атаку Burp Intrumer для того же запроса. Снова добавьте заголовок X-Forwarded-For и добавьте к нему позицию полезных данных. Вставьте имя пользователя, которое вы только что определили, и добавьте позицию полезных данных в параметр password.
11.  На вкладке «Payloads» добавьте список чисел в набор полезных данных 1 и список паролей в набор полезных данных 2. «Start the attack».
13.  Когда атака завершится, найдите ответ со статусом 302. Запишите этот пароль.

14.  Войдите в систему, используя имя пользователя и пароль, которые вы указали, и получите доступ к странице учетной записи пользователя, чтобы выполнить лабораторную работу.
   
Примечание

     Также возможно взломать вход в систему с помощью одной атаки кластерной бомбой. Однако, как правило, гораздо эффективнее сначала перечислить допустимое имя пользователя, если это возможно.

Особенности в intruder:
Attack type - Pitchfork
Pyaloads - из двух частей в два этапа:
Настройки первой нагрузки одинаковые для всех:
Payload type - Numbers
Number range:
From - 0
To - 200
Step - 1
Number format:
Max fraction digits - 0



Первый этап перебор имени с очень длинным паролем, что даст нам воможность увидеть долгое время ответа сервера на сравнение пароля:

X-Forwarded-For: §0§

username=§appserver§&password=0ada00b30383d28d81282b0400ae00970ada00b30383d28d81282b0400ae00970ada00b30383d28d81282b0400ae00970ada00b30383d28d81282b0400ae00970ada00b30383d28d81282b0400ae00970ada00b30383d28d81282b0400ae0097

Второя часть это уже перебор логинов (с длинными ответами, у меня их было три archie, athena, appserver), для них устраиваем перебор паролей:

X-Forwarded-For: §0§

username=appserver&password=§test§



username=appserver&password=cheese
с третей попытки
