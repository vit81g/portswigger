https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic

# Lab: Password reset broken logic
Лабораторная работа: Логика сброса пароля

Функция сброса пароля этой лаборатории уязвима. Чтобы пройти лабораторную работу, сбросьте пароль Карлоса, затем войдите в систему и откройте его страницу «Моя учетная запись».

Solution:
1.  Запустив Burp, нажмите «Forgot your password?». ссылку и введите свое имя пользователя.
2.  Нажмите кнопку «Email client», чтобы просмотреть отправленное электронное письмо для сброса пароля. Нажмите на ссылку в электронном письме и сбросьте пароль на любой другой.
3.  В Burp перейдите в раздел Proxy > HTTP history и изучите запросы и ответы для функции сброса пароля. Обратите внимание, что токен сброса предоставляется в качестве параметра URL-запроса в электронном письме о сбросе. Обратите внимание: когда вы отправляете новый пароль, запрос POST /forgot-password?temp-forgot-password-token содержит имя пользователя в качестве скрытых входных данных. Отправьте этот запрос в Burp Repeater.
4.  Обратите внимание, что в Burp Repeater функция сброса пароля по-прежнему работает, даже если вы удалите значение параметра temp-forgot-password-token как в URL-адресе, так и в теле запроса. Это подтверждает, что токен не проверяется при отправке нового пароля.
5.  В браузере запросите сброс нового пароля и снова измените пароль. Отправьте запрос POST /forgot-password?temp-forgot-password-token в Burp Repeater еще раз.
6.  В Burp Repeater удалите значение параметра temp-forgot-password-token как в URL-адресе, так и в теле запроса. Измените параметр username на carlos. Установите новый пароль, какой хотите, и отправьте запрос.
7.  В браузере войдите в учетную запись Карлоса, используя только что установленный новый пароль. Нажмите «Моя учетная запись», чтобы выполнить лабораторную работу.


Решение:
Start Burp Suite
1. Заходим в my account и нажимаем Forgot your password?
2. Вводим нашу почту
3. Переходим по ссылке в почте и вводим новый логин/пароль
4. смотрим HTTP history -> находим наши данные сброса -> /forgot-password?temp-forgot-password-token   (POST)
Там есть параметр username=wiener
5. Меняем username=wiener на username=carlos (пароль тоже можно поменять)
6. Пароль сброшен.
заходим в my account


