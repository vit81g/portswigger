Authentication vulnerabilities
Уязвимости аутентификации

Концептуально уязвимости аутентификации легко понять. Однако они обычно имеют решающее значение из-за четкой взаимосвязи между аутентификацией и безопасностью.

Уязвимости аутентификации могут позволить злоумышленникам получить доступ к конфиденциальным данным и функциям. Они также открывают дополнительную поверхность атаки для дальнейших эксплойтов. По этой причине важно научиться выявлять и использовать уязвимости аутентификации, а также обходить общие меры защиты.

В этом разделе мы объясняем:

     Наиболее распространенные механизмы аутентификации, используемые веб-сайтами.
     Потенциальные уязвимости в этих механизмах.
     Внутренние уязвимости в различных механизмах аутентификации.
     Типичные уязвимости, возникающие при их неправильной реализации.
     Как сделать свои собственные механизмы аутентификации максимально надежными.
     
В чем разница между аутентификацией и авторизацией?

Аутентификация — это процесс проверки того, что пользователь является тем, за кого себя выдает. Авторизация включает в себя проверку того, разрешено ли пользователю что-либо делать.

Например, аутентификация определяет, действительно ли кто-то, пытающийся получить доступ к веб-сайту с именем пользователя Carlos123, является тем же человеком, который создал учетную запись.

После аутентификации Carlos123 его разрешения определяют, что ему разрешено делать. Например, им может быть разрешен доступ к личной информации о других пользователях или выполнение таких действий, как удаление учетной записи другого пользователя.

Brute-force attacks
Атаки грубой силы

Атака методом перебора — это когда злоумышленник использует систему проб и ошибок, чтобы угадать действительные учетные данные пользователя. Эти атаки обычно автоматизируются с использованием списков имен пользователей и паролей. Автоматизация этого процесса, особенно с использованием специальных инструментов, потенциально позволяет злоумышленнику совершать огромное количество попыток входа в систему на высокой скорости.

Брутфорс – это не всегда просто случайный подбор имен пользователей и паролей. Используя базовую логику или общедоступные знания, злоумышленники могут точно настроить атаки методом перебора, чтобы сделать гораздо более обоснованные предположения. Это значительно повышает эффективность подобных атак. Веб-сайты, которые используют вход на основе пароля в качестве единственного метода аутентификации пользователей, могут быть очень уязвимыми, если они не реализуют достаточную защиту от перебора.

Brute-forcing usernames
Брутфорс имен пользователей

Имена пользователей особенно легко угадать, если они соответствуют узнаваемому шаблону, например адресу электронной почты. Например, очень часто можно увидеть бизнес-логины в формате имя.фамилия@некотораякомпания.com. Однако даже если очевидной закономерности нет, иногда даже учетные записи с высокими привилегиями создаются с использованием предсказуемых имен пользователей, таких как admin или администратор.

Во время аудита проверьте, раскрывает ли сайт публично потенциальные имена пользователей. Например, можете ли вы получить доступ к профилям пользователей без входа в систему? Даже если фактическое содержимое профилей скрыто, имя, используемое в профиле, иногда совпадает с именем пользователя для входа. Вам также следует проверить ответы HTTP, чтобы узнать, раскрыты ли какие-либо адреса электронной почты. Иногда ответы содержат адреса электронной почты пользователей с высокими привилегиями, например администраторов или сотрудников ИТ-поддержки.

Brute-forcing passwords
Подбор паролей

Пароли также могут быть подобраны методом перебора, причем сложность зависит от сложности пароля. Многие веб-сайты применяют ту или иную форму политики паролей, которая вынуждает пользователей создавать пароли с высокой энтропией, которые, по крайней мере теоретически, труднее взломать, используя только грубую силу. Обычно это включает в себя принудительное использование паролей с помощью:

     Минимальное количество символов
     Смесь строчных и прописных букв
     Хотя бы один специальный символ

Однако, хотя пароли с высокой энтропией сложно взломать только компьютерам, мы можем использовать базовые знания о человеческом поведении, чтобы использовать уязвимости, которые пользователи невольно привносят в эту систему. Вместо того, чтобы создавать надежный пароль со случайной комбинацией символов, пользователи часто берут пароль, который они могут запомнить, и пытаются взломать его, чтобы он соответствовал политике паролей. Например, если mypassword не разрешен, пользователи могут попробовать что-то вроде Mypassword1! или вместо этого Myp4$$w0rd.

В тех случаях, когда политика требует, чтобы пользователи регулярно меняли свои пароли, пользователи также обычно вносят незначительные, предсказуемые изменения в свой предпочтительный пароль. Например, Mypassword1!становится  Mypassword1? или Mypassword2!.

Знание вероятных учетных данных и предсказуемых шаблонов означает, что атаки методом перебора часто могут быть гораздо более изощренными и, следовательно, эффективными, чем простое перебор всех возможных комбинаций символов.


Username enumeration
Перечисление имени пользователя

Перечисление имен пользователей — это когда злоумышленник может наблюдать изменения в поведении веб-сайта, чтобы определить, является ли данное имя пользователя действительным.

Перечисление имени пользователя обычно происходит либо на странице входа, например, когда вы вводите действительное имя пользователя, но неправильный пароль, либо в формах регистрации, когда вы вводите уже занятое имя пользователя. Это значительно сокращает время и усилия, необходимые для подбора логина, поскольку злоумышленник может быстро создать короткий список действительных имен пользователей.

При попытке перебора страницы входа вам следует обратить особое внимание на любые различия в:

     Коды состояния. Во время атаки методом перебора возвращаемый код состояния HTTP, скорее всего, будет одинаковым для подавляющего большинства предположений, поскольку большинство из них будут неправильными. Если предположение возвращает другой код состояния, это является убедительным признаком того, что имя пользователя было правильным. Лучше всего, чтобы веб-сайты всегда возвращали один и тот же код состояния независимо от результата, но эта практика не всегда соблюдается.
     Сообщения об ошибках: иногда возвращаемое сообщение об ошибке различается в зависимости от того, неверны ли имя пользователя и пароль или неверен только пароль. На веб-сайтах рекомендуется использовать одинаковые общие сообщения в обоих случаях, но иногда случаются небольшие ошибки при вводе. Всего лишь один неуместный символ делает два сообщения разными, даже в тех случаях, когда символ не виден на отображаемой странице.
     Время ответа: если большинство запросов были обработаны с одинаковым временем ответа, любые отклонения от этого значения предполагают, что за кулисами происходило что-то другое. Это еще один признак того, что угаданное имя пользователя может быть правильным. Например, веб-сайт может проверять правильность пароля только в том случае, если имя пользователя действительно. Этот дополнительный шаг может привести к небольшому увеличению времени ответа. Это может быть незаметно, но злоумышленник может сделать эту задержку более очевидной, введя слишком длинный пароль, на обработку которого веб-сайту потребуется заметно больше времени.
