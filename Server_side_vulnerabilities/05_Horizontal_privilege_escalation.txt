Horizontal privilege escalation
Горизонтальное повышение привилегий

Горизонтальное повышение привилегий происходит, если пользователь может получить доступ к ресурсам, принадлежащим другому пользователю, вместо своих собственных ресурсов этого типа. Например, если сотрудник может получить доступ к записям других сотрудников, а также к своим собственным, то это горизонтальное повышение привилегий.

Атаки горизонтального повышения привилегий могут использовать методы эксплойта, аналогичные методам вертикального повышения привилегий. Например, пользователь может получить доступ к странице своей учетной записи, используя следующий URL-адрес:
https://insecure-website.com/myaccount?id=123

Если злоумышленник изменяет значение параметра id на значение другого пользователя, он может получить доступ к странице учетной записи другого пользователя и связанным с ней данным и функциям.
Примечание

Это пример небезопасной уязвимости прямой ссылки на объект (IDOR). Этот тип уязвимости возникает, когда значения параметров пользовательского контроллера используются для прямого доступа к ресурсам или функциям.

В некоторых приложениях эксплуатируемый параметр не имеет предсказуемого значения. Например, вместо возрастающего числа приложение может использовать глобальные уникальные идентификаторы (GUID) для идентификации пользователей. Это может помешать злоумышленнику угадать или предсказать идентификатор другого пользователя. Однако идентификаторы GUID, принадлежащие другим пользователям, могут быть раскрыты в другом месте приложения, где упоминаются пользователи, например в сообщениях или отзывах пользователей.


Эта лаборатория имеет уязвимость горизонтального повышения привилегий на странице учетной записи пользователя, но идентифицирует пользователей по GUID.

Чтобы решить лабораторную задачу, найдите GUID Карлоса, а затем отправьте его ключ API в качестве решения.

Вы можете войти в свою учетную запись, используя следующие учетные данные: wiener:peter.

     Найдите сообщение в блоге Карлоса.
     Нажмите на Карлоса и обратите внимание, что URL-адрес содержит его идентификатор пользователя. Запишите этот идентификатор.
     Войдите в систему, используя предоставленные учетные данные, и получите доступ к странице своей учетной записи.
     Измените параметр «id» на сохраненный идентификатор пользователя.
     Получите и отправьте ключ API.

Решение:
1. Start burp suite
2. зайти под в лк с учетными данными: wiener:peter
3. посмотреть записи блога, найти carlos
4. выявить его id  (51427587-9c7b-4acd-97e9-f9069cc9bc59)
5. найти свои данные в burp suite, где указан id и поменять его на id carlos с помощью Repeater
6. найти в Response API carlos

https://0a8c007203ca7254800cd5e300f40050.web-security-academy.net/blogs?userId=51427587-9c7b-4acd-97e9-f9069cc9bc59

id carlos:
51427587-9c7b-4acd-97e9-f9069cc9bc59

API carlos:
iUDmlC3qolWeHBHQVuwmLrTK0ZDPmVY4

API wiener (my):
x5QLvt2uUXvETiru6mKwC2cmRCv3X7Sr
